788c788
<     onHide(!autoClosed && focusOnHover);
---
>     onHide(!autoClosed);
861a862,869
> 
>         if (shownChildMenu != null
>             && shownChildMenu == selectedItem.getSubMenu())
>         {
>           shownChildMenu.onHide(false);
>           popup.hide();
>           shownChildMenu = null;
>         }
980c988
<   void doItemAction(final MenuItem item, boolean fireCommand, boolean focus) {
---
>   protected void doItemAction(final MenuItem item, boolean fireCommand, boolean focus) {
1092c1100
<   void updateSubmenuIcon(MenuItem item) {
---
>   protected void updateSubmenuIcon(MenuItem item) {
1108c1116
<     if (submenu == null) {
---
>     if (submenu == null || !item.isVisible()) {
1119c1127,1132
<       td.setInnerSafeHtml(subMenuIcon.getSafeHtml());
---
>       String indicatorHtml = subMenuIcon.getSafeHtml().asString();
>       // add null alt attribute for a11y
>       if (indicatorHtml.startsWith("<img") && indicatorHtml.endsWith(">"))
>         indicatorHtml = indicatorHtml.substring(0, indicatorHtml.length() - 1) + " alt>";
>       td.setInnerHTML(indicatorHtml);
> 
1197a1211
>     Roles.getPresentationRole().set(table);
1334c1348
<         if (nextItem.isEnabled()) {
---
>         if (nextItem.isEnabled() && nextItem.isVisible()) {
1336c1350,1356
<           break;
---
>           return true;
>         }
>       }
>       for (MenuItem nextItem : items) {
>         if (nextItem.isVisible()) {
>           selectItem(nextItem);
>           return true;
1369c1389
<         if (itemToBeSelected.isEnabled()) {
---
>         if (itemToBeSelected.isEnabled() && itemToBeSelected.isVisible()) {
1406c1426
<         if (itemToBeSelected.isEnabled()) {
---
>         if (itemToBeSelected.isEnabled() && itemToBeSelected.isVisible()) {
