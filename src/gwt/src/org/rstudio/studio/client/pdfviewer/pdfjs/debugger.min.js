var FontInspector=function(){function g(){for(var b=document.querySelectorAll("div["+f+"]"),a=0,c=b.length;a<c;++a)b[a].className="debuggerHideText"}function e(b,a){for(var c=document.querySelectorAll("div["+f+"="+b+"]"),d=0,e=c.length;d<e;++d)c[d].className=a?"debuggerShowText":"debuggerHideText"}function a(b){if(b.target.dataset.fontName&&"DIV"==b.target.tagName)for(var b=b.target.dataset.fontName,a=document.getElementsByTagName("input"),c=0;c<a.length;++c){var f=a[c];f.dataset.fontName==b&&(f.checked=
!f.checked,e(b,f.checked),f.scrollIntoView())}}var c,d=!1,f="data-font-name";return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function(){var b=this.panel;b.setAttribute("style","padding: 5px;");var a=document.createElement("button");a.addEventListener("click",g);a.textContent="Refresh";b.appendChild(a);c=document.createElement("div");b.appendChild(c)},enabled:!1,get active(){return d},set active(b){if(d=b)document.body.addEventListener("click",a,!0),g();else{document.body.removeEventListener("click",
a,!0);for(var b=document.querySelectorAll("div["+f+"]"),c=0,e=b.length;c<e;++c)b[c].className=""}},fontAdded:function(b,a){var f=function(b,a){for(var c=document.createElement("table"),f=0;f<a.length;f++){var d=document.createElement("tr"),e=document.createElement("td");e.textContent=a[f];d.appendChild(e);e=document.createElement("td");e.textContent=b[a[f]].toString();d.appendChild(e);c.appendChild(d)}return c}(b,["name","type"]),d=/url\(['"]?([^\)"']+)/.exec(a),m=b.loadedName,h=document.createElement("div"),
i=document.createElement("span");i.textContent=m;var o=document.createElement("a");o.href=d[1];o.textContent="Download";d=document.createElement("a");d.href="";d.textContent="Log";d.addEventListener("click",function(a){a.preventDefault();console.log(b)});var n=document.createElement("input");n.setAttribute("type","checkbox");n.dataset.fontName=m;n.addEventListener("click",function(b,a){return function(){e(a,b.checked)}}(n,m));h.appendChild(n);h.appendChild(i);h.appendChild(document.createTextNode(" "));
h.appendChild(o);h.appendChild(document.createTextNode(" "));h.appendChild(d);h.appendChild(f);c.appendChild(h);setTimeout(function(){this.active&&g()}.bind(this),2E3)}}}(),StepperManager=function(){var g=[],e=null,a=null,c=null,d={};return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function(){var f=this;this.panel.setAttribute("style","padding: 5px;");a=document.createElement("div");c=document.createElement("select");c.addEventListener("change",function(){f.selectStepper(this.value)});
a.appendChild(c);e=document.createElement("div");this.panel.appendChild(a);this.panel.appendChild(e);sessionStorage.getItem("pdfjsBreakPoints")&&(d=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints")))},enabled:!1,active:!1,create:function(a){var b=document.createElement("div");b.id="stepper"+a;b.setAttribute("hidden",!0);b.className="stepper";e.appendChild(b);var j=document.createElement("option");j.textContent="Page "+(a+1);j.value=a;c.appendChild(j);b=new Stepper(b,a,d[a]||[]);g.push(b);1===
g.length&&this.selectStepper(a,!1);return b},selectStepper:function(a,b){b&&this.manager.selectPanel(1);for(var d=0;d<g.length;++d){var e=g[d];e.pageNumber==a?e.panel.removeAttribute("hidden"):e.panel.setAttribute("hidden",!0)}e=c.options;for(d=0;d<e.length;++d){var l=e[d];l.selected=l.value==a}},saveBreakPoints:function(a,b){d[a]=b;sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(d))}}}(),Stepper=function(){function g(e,a,c){this.panel=e;this.len;this.breakPoint=0;this.nextBreakPoint=null;
this.pageNumber=a;this.breakPoints=c;this.currentIdx=-1}g.prototype={init:function(e){function a(a,b){var c=document.createElement(a);b&&(c.textContent=b);return c}var c=this.panel;this.len=e.fnArray.length;var d=a("div","c=continue, s=step"),f=a("table");d.appendChild(f);f.cellSpacing=0;var b=a("tr");f.appendChild(b);b.appendChild(a("th","Break"));b.appendChild(a("th","Idx"));b.appendChild(a("th","fn"));b.appendChild(a("th","args"));for(b=0;b<e.fnArray.length;b++){var g=a("tr");g.className="line";
g.dataset.idx=b;f.appendChild(g);var k=-1!=this.breakPoints.indexOf(b),l=e.argsArray[b]?e.argsArray[b]:[],m=a("td"),h=a("input");h.type="checkbox";h.className="points";h.checked=k;var i=this;h.onclick=function(a){return function(){this.checked?i.breakPoints.push(a):i.breakPoints.splice(i.breakPoints.indexOf(a),1);StepperManager.saveBreakPoints(i.pageNumber,i.breakPoints)}}(b);m.appendChild(h);g.appendChild(m);g.appendChild(a("td",b.toString()));g.appendChild(a("td",e.fnArray[b]));g.appendChild(a("td",
l.join(", ")))}c.appendChild(d);i=this},getNextBreakPoint:function(){this.breakPoints.sort(function(a,c){return a-c});for(var e=0;e<this.breakPoints.length;e++)if(this.breakPoints[e]>this.currentIdx)return this.breakPoints[e];return null},breakIt:function(e,a){StepperManager.selectStepper(this.pageNumber,!0);var c=this,d=document;c.currentIdx=e;var f=function(b){switch(b.keyCode){case 83:d.removeEventListener("keydown",f,!1);c.nextBreakPoint=c.currentIdx+1;c.goTo(-1);a();break;case 67:d.removeEventListener("keydown",
f,!1),b=c.getNextBreakPoint(),c.nextBreakPoint=b,c.goTo(-1),a()}};d.addEventListener("keydown",f,!1);c.goTo(e)},goTo:function(e){for(var a=this.panel.getElementsByClassName("line"),c=0,d=a.length;c<d;++c){var f=a[c];f.dataset.idx==e?(f.style.backgroundColor="rgb(251,250,207)",f.scrollIntoView()):f.style.backgroundColor=null}}};return g}(),PDFBug=function(){var g=[],e=null;return{tools:[FontInspector,StepperManager],init:function(){var a=document.createElement("div");a.id="PDFBug";var c=document.createElement("div");
c.setAttribute("class","controls");a.appendChild(c);var d=document.createElement("div");d.setAttribute("class","panels");a.appendChild(d);document.body.appendChild(a);document.body.style.paddingRight="300px";for(var a=this.tools,e=0;e<a.length;++e){var b=a[e],j=document.createElement("div"),k=document.createElement("button");k.textContent=b.name;var l=this;k.addEventListener("click",function(a){return function(b){b.preventDefault();l.selectPanel(a)}}(e));c.appendChild(k);d.appendChild(j);b.panel=
j;b.manager=this;b.enabled?b.init():j.textContent=b.name+' is disabled. To enable add  "'+b.id+'" to the pdfBug parameter and refresh (seperate multiple by commas).';g.push(k)}this.selectPanel(0)},selectPanel:function(a){if(a!==e){e=a;for(var c=this.tools,d=0;d<c.length;++d)d==a?(g[d].setAttribute("class","active"),c[d].active=!0,c[d].panel.removeAttribute("hidden")):(g[d].setAttribute("class",""),c[d].active=!1,c[d].panel.setAttribute("hidden","true"))}}}}();
