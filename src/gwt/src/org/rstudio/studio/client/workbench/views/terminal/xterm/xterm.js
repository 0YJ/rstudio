(function(x){"object"===typeof exports&&"undefined"!==typeof module?module.exports=x():"function"===typeof define&&define.amd?define([],x):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).Terminal=x()})(function(){return function g(l,i,b){function f(a,d){if(!i[a]){if(!l[a]){var j="function"==typeof require&&require;if(!d&&j)return j(a,!0);if(c)return c(a,!0);j=Error("Cannot find module '"+a+"'");throw j.code="MODULE_NOT_FOUND",j;}j=i[a]={exports:{}};
l[a][0].call(j.exports,function(h){var d=l[a][1][h];return f(d?d:h)},j,j.exports,g,l,i,b)}return i[a].exports}for(var c="function"==typeof require&&require,d=0;d<b.length;d++)f(b[d]);return f}({1:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});i.CHARSETS={};i.DEFAULT_CHARSET=i.CHARSETS.B;i.CHARSETS["0"]={"`":"\u25c6",a:"\u2592",b:"\t",c:"\u000c",d:"\r",e:"\n",f:"\u00b0",g:"\u00b1",h:"\u2424",i:"\x0B",j:"\u2518",k:"\u2510",l:"\u250c",m:"\u2514",n:"\u253c",o:"\u23ba",p:"\u23bb",q:"\u2500",
r:"\u23bc",s:"\u23bd",t:"\u251c",u:"\u2524",v:"\u2534",w:"\u252c",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03c0","|":"\u2260","}":"\u00a3","~":"\u00b7"};i.CHARSETS.A={"#":"\u00a3"};i.CHARSETS.B=null;i.CHARSETS["4"]={"#":"\u00a3","@":"\u00be","[":"ij","\\":"\u00bd","]":"|","{":"\u00a8","|":"f","}":"\u00bc","~":"\u00b4"};i.CHARSETS.C=i.CHARSETS["5"]={"[":"\u00c4","\\":"\u00d6","]":"\u00c5","^":"\u00dc","`":"\u00e9","{":"\u00e4","|":"\u00f6","}":"\u00e5","~":"\u00fc"};i.CHARSETS.R={"#":"\u00a3","@":"\u00e0",
"[":"\u00b0","\\":"\u00e7","]":"\u00a7","{":"\u00e9","|":"\u00f9","}":"\u00e8","~":"\u00a8"};i.CHARSETS.Q={"@":"\u00e0","[":"\u00e2","\\":"\u00e7","]":"\u00ea","^":"\u00ee","`":"\u00f4","{":"\u00e9","|":"\u00f9","}":"\u00e8","~":"\u00fb"};i.CHARSETS.K={"@":"\u00a7","[":"\u00c4","\\":"\u00d6","]":"\u00dc","{":"\u00e4","|":"\u00f6","}":"\u00fc","~":"\u00df"};i.CHARSETS.Y={"#":"\u00a3","@":"\u00a7","[":"\u00b0","\\":"\u00e7","]":"\u00e9","`":"\u00f9","{":"\u00e0","|":"\u00f2","}":"\u00e8","~":"\u00ec"};
i.CHARSETS.E=i.CHARSETS["6"]={"@":"\u00c4","[":"\u00c6","\\":"\u00d8","]":"\u00c5","^":"\u00dc","`":"\u00e4","{":"\u00e6","|":"\u00f8","}":"\u00e5","~":"\u00fc"};i.CHARSETS.Z={"#":"\u00a3","@":"\u00a7","[":"\u00a1","\\":"\u00d1","]":"\u00bf","{":"\u00b0","|":"\u00f1","}":"\u00e7"};i.CHARSETS.H=i.CHARSETS["7"]={"@":"\u00c9","[":"\u00c4","\\":"\u00d6","]":"\u00c5","^":"\u00dc","`":"\u00e9","{":"\u00e4","|":"\u00f6","}":"\u00e5","~":"\u00fc"};i.CHARSETS["="]={"#":"\u00f9","@":"\u00e0","[":"\u00e9","\\":"\u00e7",
"]":"\u00ea","^":"\u00ee",_:"\u00e8","`":"\u00f4","{":"\u00e4","|":"\u00f6","}":"\u00fc","~":"\u00fb"}},{}],2:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});g=function(){function b(b,c,d){this.textarea=b;this.compositionView=c;this.terminal=d;this.isSendingComposition=this.isComposing=!1;this.compositionPosition={start:null,end:null}}b.prototype.compositionstart=function(){this.isComposing=!0;this.compositionPosition.start=this.textarea.value.length;this.compositionView.textContent=
"";this.compositionView.classList.add("active")};b.prototype.compositionupdate=function(b){var c=this;this.compositionView.textContent=b.data;this.updateCompositionElements();setTimeout(function(){c.compositionPosition.end=c.textarea.value.length},0)};b.prototype.compositionend=function(){this.finalizeComposition(!0)};b.prototype.keydown=function(b){if(this.isComposing||this.isSendingComposition){if(229===b.keyCode||16===b.keyCode||17===b.keyCode||18===b.keyCode)return!1;this.finalizeComposition(!1)}return 229===
b.keyCode?(this.handleAnyTextareaChanges(),!1):!0};b.prototype.finalizeComposition=function(b){var c=this;this.compositionView.classList.remove("active");this.isComposing=!1;this.clearTextareaPosition();if(b){var d=this.compositionPosition.start,a=this.compositionPosition.end;this.isSendingComposition=!0;setTimeout(function(){if(c.isSendingComposition){c.isSendingComposition=!1;var b=void 0,b=c.isComposing?c.textarea.value.substring(d,a):c.textarea.value.substring(d);c.terminal.handler(b)}},0)}else this.isSendingComposition=
!1,this.terminal.handler(this.textarea.value.substring(this.compositionPosition.start,this.compositionPosition.end))};b.prototype.handleAnyTextareaChanges=function(){var b=this,c=this.textarea.value;setTimeout(function(){if(!b.isComposing){var d=b.textarea.value.replace(c,"");0<d.length&&b.terminal.handler(d)}},0)};b.prototype.updateCompositionElements=function(b){var c=this;if(this.isComposing){var d=this.terminal.element.querySelector(".terminal-cursor");if(d){var a=this.terminal.element.querySelector(".xterm-rows").offsetTop+
d.offsetTop;this.compositionView.style.left=d.offsetLeft+"px";this.compositionView.style.top=a+"px";this.compositionView.style.height=d.offsetHeight+"px";this.compositionView.style.lineHeight=d.offsetHeight+"px";var o=this.compositionView.getBoundingClientRect();this.textarea.style.left=d.offsetLeft+"px";this.textarea.style.top=a+"px";this.textarea.style.width=o.width+"px";this.textarea.style.height=o.height+"px";this.textarea.style.lineHeight=o.height+"px"}b||setTimeout(function(){return c.updateCompositionElements(!0)},
0)}};b.prototype.clearTextareaPosition=function(){this.textarea.style.left="";this.textarea.style.top=""};return b}();i.CompositionHelper=g},{}],3:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});g=i.C0||(i.C0={});g.NUL="\x00";g.SOH="\u0001";g.STX="\u0002";g.ETX="\u0003";g.EOT="\u0004";g.ENQ="\u0005";g.ACK="\u0006";g.BEL="\u0007";g.BS="\u0008";g.HT="\t";g.LF="\n";g.VT="\x0B";g.FF="\u000c";g.CR="\r";g.SO="\u000e";g.SI="\u000f";g.DLE="\u0010";g.DC1="\u0011";g.DC2="\u0012";g.DC3="\u0013";
g.DC4="\u0014";g.NAK="\u0015";g.SYN="\u0016";g.ETB="\u0017";g.CAN="\u0018";g.EM="\u0019";g.SUB="\u001a";g.ESC="\u001b";g.FS="\u001c";g.GS="\u001d";g.RS="\u001e";g.US="\u001f";g.SP=" ";g.DEL="\u007f"},{}],4:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});g=function(){function b(){this._events=this._events||{}}b.prototype.on=function(b,c){this._events[b]=this._events[b]||[];this._events[b].push(c)};b.prototype.off=function(b,c){if(this._events[b])for(var d=this._events[b],a=d.length;a--;)if(d[a]===
c||d[a].listener===c){d.splice(a,1);break}};b.prototype.removeAllListeners=function(b){this._events[b]&&delete this._events[b]};b.prototype.once=function(b,c){function d(){var a=Array.prototype.slice.call(arguments);this.off(b,d);return c.apply(this,a)}d.listener=c;return this.on(b,d)};b.prototype.emit=function(b){if(this._events[b])for(var c=Array.prototype.slice.call(arguments,1),d=this._events[b],a=0;a<d.length;a++)d[a].apply(this,c)};b.prototype.listeners=function(b){return this._events[b]||[]};
return b}();i.EventEmitter=g},{}],5:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});var b=g("./EscapeSequences"),f=g("./Charsets"),g=function(){function d(a){this._terminal=a}d.prototype.addChar=function(a,b){if(" "<=a){var d=c(b);this._terminal.charset&&this._terminal.charset[a]&&(a=this._terminal.charset[a]);var h=this._terminal.y+this._terminal.ybase;if(!d&&this._terminal.x)this._terminal.lines.get(h)[this._terminal.x-1]&&(this._terminal.lines.get(h)[this._terminal.x-1][2]?this._terminal.lines.get(h)[this._terminal.x-
1][1]+=a:this._terminal.lines.get(h)[this._terminal.x-2]&&(this._terminal.lines.get(h)[this._terminal.x-2][1]+=a),this._terminal.updateRange(this._terminal.y));else{if(this._terminal.x+d-1>=this._terminal.cols)if(this._terminal.wraparoundMode)this._terminal.x=0,this._terminal.y++,this._terminal.y>this._terminal.scrollBottom&&(this._terminal.y--,this._terminal.scroll());else if(2===d)return;h=this._terminal.y+this._terminal.ybase;if(this._terminal.insertMode)for(var k=0;k<d;++k)0===this._terminal.lines.get(this._terminal.y+
this._terminal.ybase).pop()[2]&&this._terminal.lines.get(h)[this._terminal.cols-2]&&2===this._terminal.lines.get(h)[this._terminal.cols-2][2]&&(this._terminal.lines.get(h)[this._terminal.cols-2]=[this._terminal.curAttr," ",1]),this._terminal.lines.get(h).splice(this._terminal.x,0,[this._terminal.curAttr," ",1]);this._terminal.lines.get(h)[this._terminal.x]=[this._terminal.curAttr,a,d];this._terminal.x++;this._terminal.updateRange(this._terminal.y);2===d&&(this._terminal.lines.get(h)[this._terminal.x]=
[this._terminal.curAttr,"",0],this._terminal.x++)}}};d.prototype.bell=function(){var a=this;this._terminal.visualBell&&(this._terminal.element.style.borderColor="white",setTimeout(function(){return a._terminal.element.style.borderColor=""},10),this._terminal.popOnBell&&this._terminal.focus())};d.prototype.lineFeed=function(){this._terminal.convertEol&&(this._terminal.x=0);this._terminal.y++;this._terminal.y>this._terminal.scrollBottom&&(this._terminal.y--,this._terminal.scroll());this._terminal.x>=
this._terminal.cols&&this._terminal.x--};d.prototype.carriageReturn=function(){this._terminal.x=0};d.prototype.backspace=function(){0<this._terminal.x&&this._terminal.x--};d.prototype.tab=function(){this._terminal.x=this._terminal.nextStop()};d.prototype.shiftOut=function(){this._terminal.setgLevel(1)};d.prototype.shiftIn=function(){this._terminal.setgLevel(0)};d.prototype.insertChars=function(a){var b,d,h,a=a[0];1>a&&(a=1);b=this._terminal.y+this._terminal.ybase;d=this._terminal.x;for(h=[this._terminal.eraseAttr(),
" ",1];a--&&d<this._terminal.cols;)this._terminal.lines.get(b).splice(d++,0,h),this._terminal.lines.get(b).pop()};d.prototype.cursorUp=function(a){a=a[0];1>a&&(a=1);this._terminal.y-=a;0>this._terminal.y&&(this._terminal.y=0)};d.prototype.cursorDown=function(a){a=a[0];1>a&&(a=1);this._terminal.y+=a;this._terminal.y>=this._terminal.rows&&(this._terminal.y=this._terminal.rows-1);this._terminal.x>=this._terminal.cols&&this._terminal.x--};d.prototype.cursorForward=function(a){a=a[0];1>a&&(a=1);this._terminal.x+=
a;this._terminal.x>=this._terminal.cols&&(this._terminal.x=this._terminal.cols-1)};d.prototype.cursorBackward=function(a){a=a[0];1>a&&(a=1);this._terminal.x>=this._terminal.cols&&this._terminal.x--;this._terminal.x-=a;0>this._terminal.x&&(this._terminal.x=0)};d.prototype.cursorNextLine=function(a){a=a[0];1>a&&(a=1);this._terminal.y+=a;this._terminal.y>=this._terminal.rows&&(this._terminal.y=this._terminal.rows-1);this._terminal.x=0};d.prototype.cursorPrecedingLine=function(a){a=a[0];1>a&&(a=1);this._terminal.y-=
a;0>this._terminal.y&&(this._terminal.y=0);this._terminal.x=0};d.prototype.cursorCharAbsolute=function(a){a=a[0];1>a&&(a=1);this._terminal.x=a-1};d.prototype.cursorPosition=function(a){var b;b=a[0]-1;a=2<=a.length?a[1]-1:0;0>b?b=0:b>=this._terminal.rows&&(b=this._terminal.rows-1);0>a?a=0:a>=this._terminal.cols&&(a=this._terminal.cols-1);this._terminal.x=a;this._terminal.y=b};d.prototype.cursorForwardTab=function(a){for(a=a[0]||1;a--;)this._terminal.x=this._terminal.nextStop()};d.prototype.eraseInDisplay=
function(a){switch(a[0]){case 0:this._terminal.eraseRight(this._terminal.x,this._terminal.y);for(a=this._terminal.y+1;a<this._terminal.rows;a++)this._terminal.eraseLine(a);break;case 1:this._terminal.eraseLeft(this._terminal.x,this._terminal.y);for(a=this._terminal.y;a--;)this._terminal.eraseLine(a);break;case 2:for(a=this._terminal.rows;a--;)this._terminal.eraseLine(a)}};d.prototype.eraseInLine=function(a){switch(a[0]){case 0:this._terminal.eraseRight(this._terminal.x,this._terminal.y);break;case 1:this._terminal.eraseLeft(this._terminal.x,
this._terminal.y);break;case 2:this._terminal.eraseLine(this._terminal.y)}};d.prototype.insertLines=function(a){var b,d,a=a[0];1>a&&(a=1);b=this._terminal.y+this._terminal.ybase;d=this._terminal.rows-1-this._terminal.scrollBottom;for(d=this._terminal.rows-1+this._terminal.ybase-d+1;a--;)this._terminal.lines.length===this._terminal.lines.maxLength&&(this._terminal.lines.trimStart(1),this._terminal.ybase--,this._terminal.ydisp--,b--,d--),this._terminal.lines.splice(b,0,this._terminal.blankLine(!0)),
this._terminal.lines.splice(d,1);this._terminal.updateRange(this._terminal.y);this._terminal.updateRange(this._terminal.scrollBottom)};d.prototype.deleteLines=function(a){var b,d,a=a[0];1>a&&(a=1);b=this._terminal.y+this._terminal.ybase;d=this._terminal.rows-1-this._terminal.scrollBottom;for(d=this._terminal.rows-1+this._terminal.ybase-d;a--;)this._terminal.lines.length===this._terminal.lines.maxLength&&(this._terminal.lines.trimStart(1),this._terminal.ybase-=1,this._terminal.ydisp-=1),this._terminal.lines.splice(d+
1,0,this._terminal.blankLine(!0)),this._terminal.lines.splice(b,1);this._terminal.updateRange(this._terminal.y);this._terminal.updateRange(this._terminal.scrollBottom)};d.prototype.deleteChars=function(a){var b,d,a=a[0];1>a&&(a=1);b=this._terminal.y+this._terminal.ybase;for(d=[this._terminal.eraseAttr()," ",1];a--;)this._terminal.lines.get(b).splice(this._terminal.x,1),this._terminal.lines.get(b).push(d)};d.prototype.scrollUp=function(a){for(a=a[0]||1;a--;)this._terminal.lines.splice(this._terminal.ybase+
this._terminal.scrollTop,1),this._terminal.lines.splice(this._terminal.ybase+this._terminal.scrollBottom,0,this._terminal.blankLine());this._terminal.updateRange(this._terminal.scrollTop);this._terminal.updateRange(this._terminal.scrollBottom)};d.prototype.scrollDown=function(a){for(a=a[0]||1;a--;)this._terminal.lines.splice(this._terminal.ybase+this._terminal.scrollBottom,1),this._terminal.lines.splice(this._terminal.ybase+this._terminal.scrollTop,0,this._terminal.blankLine());this._terminal.updateRange(this._terminal.scrollTop);
this._terminal.updateRange(this._terminal.scrollBottom)};d.prototype.eraseChars=function(a){var b,d,h,a=a[0];1>a&&(a=1);b=this._terminal.y+this._terminal.ybase;d=this._terminal.x;for(h=[this._terminal.eraseAttr()," ",1];a--&&d<this._terminal.cols;)this._terminal.lines.get(b)[d++]=h};d.prototype.cursorBackwardTab=function(a){for(a=a[0]||1;a--;)this._terminal.x=this._terminal.prevStop()};d.prototype.charPosAbsolute=function(a){a=a[0];1>a&&(a=1);this._terminal.x=a-1;this._terminal.x>=this._terminal.cols&&
(this._terminal.x=this._terminal.cols-1)};d.prototype.HPositionRelative=function(a){a=a[0];1>a&&(a=1);this._terminal.x+=a;this._terminal.x>=this._terminal.cols&&(this._terminal.x=this._terminal.cols-1)};d.prototype.repeatPrecedingCharacter=function(a){for(var a=a[0]||1,b=this._terminal.lines.get(this._terminal.ybase+this._terminal.y),d=b[this._terminal.x-1]||[this._terminal.defAttr," ",1];a--;)b[this._terminal.x++]=d};d.prototype.sendDeviceAttributes=function(a){0<a[0]||(this._terminal.prefix?">"===
this._terminal.prefix&&(this._terminal.is("xterm")?this._terminal.send(b.C0.ESC+"[>0;276;0c"):this._terminal.is("rxvt-unicode")?this._terminal.send(b.C0.ESC+"[>85;95;0c"):this._terminal.is("linux")?this._terminal.send(a[0]+"c"):this._terminal.is("screen")&&this._terminal.send(b.C0.ESC+"[>83;40003;0c")):this._terminal.is("xterm")||this._terminal.is("rxvt-unicode")||this._terminal.is("screen")?this._terminal.send(b.C0.ESC+"[?1;2c"):this._terminal.is("linux")&&this._terminal.send(b.C0.ESC+"[?6c"))};
d.prototype.linePosAbsolute=function(a){a=a[0];1>a&&(a=1);this._terminal.y=a-1;this._terminal.y>=this._terminal.rows&&(this._terminal.y=this._terminal.rows-1)};d.prototype.VPositionRelative=function(a){a=a[0];1>a&&(a=1);this._terminal.y+=a;this._terminal.y>=this._terminal.rows&&(this._terminal.y=this._terminal.rows-1);this._terminal.x>=this._terminal.cols&&this._terminal.x--};d.prototype.HVPosition=function(a){1>a[0]&&(a[0]=1);1>a[1]&&(a[1]=1);this._terminal.y=a[0]-1;this._terminal.y>=this._terminal.rows&&
(this._terminal.y=this._terminal.rows-1);this._terminal.x=a[1]-1;this._terminal.x>=this._terminal.cols&&(this._terminal.x=this._terminal.cols-1)};d.prototype.tabClear=function(a){a=a[0];0>=a?delete this._terminal.tabs[this._terminal.x]:3===a&&(this._terminal.tabs={})};d.prototype.setMode=function(a){if(1<a.length)for(var b=0;b<a.length;b++)this.setMode([a[b]]);else if(this._terminal.prefix){if("?"===this._terminal.prefix)switch(a[0]){case 1:this._terminal.applicationCursor=!0;break;case 2:this._terminal.setgCharset(0,
f.DEFAULT_CHARSET);this._terminal.setgCharset(1,f.DEFAULT_CHARSET);this._terminal.setgCharset(2,f.DEFAULT_CHARSET);this._terminal.setgCharset(3,f.DEFAULT_CHARSET);break;case 3:this._terminal.savedCols=this._terminal.cols;this._terminal.resize(132,this._terminal.rows);break;case 6:this._terminal.originMode=!0;break;case 7:this._terminal.wraparoundMode=!0;break;case 66:this._terminal.log("Serial port requested application keypad.");this._terminal.applicationKeypad=!0;this._terminal.viewport.syncScrollArea();
break;case 9:case 1E3:case 1002:case 1003:this._terminal.x10Mouse=9===a[0];this._terminal.vt200Mouse=1E3===a[0];this._terminal.normalMouse=1E3<a[0];this._terminal.mouseEvents=!0;this._terminal.element.style.cursor="default";this._terminal.log("Binding to mouse events.");break;case 1004:this._terminal.sendFocus=!0;break;case 1005:this._terminal.utfMouse=!0;break;case 1006:this._terminal.sgrMouse=!0;break;case 1015:this._terminal.urxvtMouse=!0;break;case 25:this._terminal.cursorHidden=!1;break;case 1049:case 47:case 1047:this._terminal.normal||
(a={lines:this._terminal.lines,ybase:this._terminal.ybase,ydisp:this._terminal.ydisp,x:this._terminal.x,y:this._terminal.y,scrollTop:this._terminal.scrollTop,scrollBottom:this._terminal.scrollBottom,tabs:this._terminal.tabs},this._terminal.reset(),this._terminal.viewport.syncScrollArea(),this._terminal.normal=a,this._terminal.showCursor())}}else switch(a[0]){case 4:this._terminal.insertMode=!0}};d.prototype.resetMode=function(a){if(1<a.length)for(var b=0;b<a.length;b++)this.resetMode([a[b]]);else if(this._terminal.prefix){if("?"===
this._terminal.prefix)switch(a[0]){case 1:this._terminal.applicationCursor=!1;break;case 3:132===this._terminal.cols&&this._terminal.savedCols&&this._terminal.resize(this._terminal.savedCols,this._terminal.rows);delete this._terminal.savedCols;break;case 6:this._terminal.originMode=!1;break;case 7:this._terminal.wraparoundMode=!1;break;case 66:this._terminal.log("Switching back to normal keypad.");this._terminal.applicationKeypad=!1;this._terminal.viewport.syncScrollArea();break;case 9:case 1E3:case 1002:case 1003:this._terminal.x10Mouse=
!1;this._terminal.vt200Mouse=!1;this._terminal.normalMouse=!1;this._terminal.mouseEvents=!1;this._terminal.element.style.cursor="";break;case 1004:this._terminal.sendFocus=!1;break;case 1005:this._terminal.utfMouse=!1;break;case 1006:this._terminal.sgrMouse=!1;break;case 1015:this._terminal.urxvtMouse=!1;break;case 25:this._terminal.cursorHidden=!0;break;case 1049:case 47:case 1047:this._terminal.normal&&(this._terminal.lines=this._terminal.normal.lines,this._terminal.ybase=this._terminal.normal.ybase,
this._terminal.ydisp=this._terminal.normal.ydisp,this._terminal.x=this._terminal.normal.x,this._terminal.y=this._terminal.normal.y,this._terminal.scrollTop=this._terminal.normal.scrollTop,this._terminal.scrollBottom=this._terminal.normal.scrollBottom,this._terminal.tabs=this._terminal.normal.tabs,this._terminal.normal=null,this._terminal.refresh(0,this._terminal.rows-1),this._terminal.viewport.syncScrollArea(),this._terminal.showCursor())}}else switch(a[0]){case 4:this._terminal.insertMode=!1}};d.prototype.charAttributes=
function(a){if(1===a.length&&0===a[0])this._terminal.curAttr=this._terminal.defAttr;else{for(var b=a.length,d=0,h=this._terminal.curAttr>>18,k=this._terminal.curAttr>>9&511,c=this._terminal.curAttr&511,f;d<b;d++)f=a[d],30<=f&&37>=f?k=f-30:40<=f&&47>=f?c=f-40:90<=f&&97>=f?(f+=8,k=f-90):100<=f&&107>=f?(f+=8,c=f-100):0===f?(h=this._terminal.defAttr>>18,k=this._terminal.defAttr>>9&511,c=this._terminal.defAttr&511):1===f?h|=1:4===f?h|=2:5===f?h|=4:7===f?h|=8:8===f?h|=16:22===f?h&=-2:24===f?h&=-3:25===
f?h&=-5:27===f?h&=-9:28===f?h&=-17:39===f?k=this._terminal.defAttr>>9&511:49===f?c=this._terminal.defAttr&511:38===f?2===a[d+1]?(d+=2,k=this._terminal.matchColor(a[d]&255,a[d+1]&255,a[d+2]&255),-1===k&&(k=511),d+=2):5===a[d+1]&&(d+=2,k=f=a[d]&255):48===f?2===a[d+1]?(d+=2,c=this._terminal.matchColor(a[d]&255,a[d+1]&255,a[d+2]&255),-1===c&&(c=511),d+=2):5===a[d+1]&&(d+=2,c=f=a[d]&255):100===f?(k=this._terminal.defAttr>>9&511,c=this._terminal.defAttr&511):this._terminal.error("Unknown SGR attribute: %d.",
f);this._terminal.curAttr=h<<18|k<<9|c}};d.prototype.deviceStatus=function(a){if(this._terminal.prefix){if("?"===this._terminal.prefix)switch(a[0]){case 6:this._terminal.send(b.C0.ESC+"[?"+(this._terminal.y+1)+";"+(this._terminal.x+1)+"R")}}else switch(a[0]){case 5:this._terminal.send(b.C0.ESC+"[0n");break;case 6:this._terminal.send(b.C0.ESC+"["+(this._terminal.y+1)+";"+(this._terminal.x+1)+"R")}};d.prototype.softReset=function(){this._terminal.cursorHidden=!1;this._terminal.insertMode=!1;this._terminal.originMode=
!1;this._terminal.wraparoundMode=!0;this._terminal.applicationKeypad=!1;this._terminal.viewport.syncScrollArea();this._terminal.applicationCursor=!1;this._terminal.scrollTop=0;this._terminal.scrollBottom=this._terminal.rows-1;this._terminal.curAttr=this._terminal.defAttr;this._terminal.x=this._terminal.y=0;this._terminal.charset=null;this._terminal.glevel=0;this._terminal.charsets=[null]};d.prototype.setCursorStyle=function(a){a=1>a[0]?1:a[0];switch(a){case 1:case 2:this._terminal.setOption("cursorStyle",
"block");break;case 3:case 4:this._terminal.setOption("cursorStyle","underline");break;case 5:case 6:this._terminal.setOption("cursorStyle","bar")}this._terminal.setOption("cursorBlink",1===a%2)};d.prototype.setScrollRegion=function(a){this._terminal.prefix||(this._terminal.scrollTop=(a[0]||1)-1,this._terminal.scrollBottom=(a[1]&&a[1]<=this._terminal.rows?a[1]:this._terminal.rows)-1,this._terminal.x=0,this._terminal.y=0)};d.prototype.saveCursor=function(){this._terminal.savedX=this._terminal.x;this._terminal.savedY=
this._terminal.y};d.prototype.restoreCursor=function(){this._terminal.x=this._terminal.savedX||0;this._terminal.y=this._terminal.savedY||0};return d}();i.InputHandler=g;var c=function(b){var a=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],
[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],
[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],
[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];return function(c){if(0===c)return b.nul;if(32>c||127<=
c&&160>c)return b.control;var f;a:{f=0;var h=a.length-1,k;if(!(c<a[0][0]||c>a[h][1]))for(;h>=f;)if(k=Math.floor((f+h)/2),c>a[k][1])f=k+1;else if(c<a[k][0])h=k-1;else{f=!0;break a}f=!1}return f?0:4352<=c&&(4447>=c||9001===c||9002===c||11904<=c&&42191>=c&&12351!==c||44032<=c&&55203>=c||63744<=c&&64255>=c||65040<=c&&65049>=c||65072<=c&&65135>=c||65280<=c&&65376>=c||65504<=c&&65510>=c||131072<=c&&196605>=c||196608<=c&&262141>=c)?2:1}}({nul:0,control:0})},{"./Charsets":1,"./EscapeSequences":3}],6:[function(g,
l,i){Object.defineProperty(i,"__esModule",{value:!0});var b=RegExp("(?:^|[^\\da-z\\.-]+)((https?:\\/\\/)((([\\da-z\\.-]+)\\.([a-z\\.]{2,6}))|((\\d{1,3}\\.){3}\\d{1,3})|(localhost))(:\\d{1,5})?(\\/[\\/\\w\\.\\-%]*)*(\\?[0-9\\w\\[\\]\\(\\)\\/\\?\\!#@$%&'*+,:;\\=\\.\\-]*)?(#[0-9\\w\\[\\]\\(\\)\\/\\?\\!#@$%&'*+,:;\\=\\.\\-]*)?)($|[^\\/\\w\\.\\-%]+)"),f=0,g=function(){function c(d,a){this._nextLinkMatcherId=f;this._document=d;this._rows=a;this._rowTimeoutIds=[];this._linkMatchers=[];this.registerLinkMatcher(b,
null,{matchIndex:1})}c.prototype.linkifyRow=function(b){var a=this._rowTimeoutIds[b];a&&clearTimeout(a);this._rowTimeoutIds[b]=setTimeout(this._linkifyRow.bind(this,b),c.TIME_BEFORE_LINKIFY)};c.prototype.attachHypertextLinkHandler=function(b){this._linkMatchers[f].handler=b};c.prototype.registerLinkMatcher=function(b,a,c){void 0===c&&(c={});if(this._nextLinkMatcherId!==f&&!a)throw Error("handler must be defined");b={id:this._nextLinkMatcherId++,regex:b,handler:a,matchIndex:c.matchIndex,validationCallback:c.validationCallback,
priority:c.priority||0};this._addLinkMatcherToList(b);return b.id};c.prototype._addLinkMatcherToList=function(b){if(0===this._linkMatchers.length)this._linkMatchers.push(b);else{for(var a=this._linkMatchers.length-1;0<=a;a--)if(b.priority<=this._linkMatchers[a].priority){this._linkMatchers.splice(a+1,0,b);return}this._linkMatchers.splice(0,0,b)}};c.prototype.deregisterLinkMatcher=function(b){for(var a=1;a<this._linkMatchers.length;a++)if(this._linkMatchers[a].id===b)return this._linkMatchers.splice(a,
1),!0;return!1};c.prototype._linkifyRow=function(b){var a=this._rows[b];if(a)for(var c=a.textContent,a=function(a){var a=g._linkMatchers[a],h=g._findLinkMatch(c,a.regex,a.matchIndex);if(h){var k=g._doLinkifyRow(b,h,a.handler,a.id===f);k&&a.validationCallback&&a.validationCallback(h,function(a){a||k.classList.add("xterm-invalid-link")});return{value:void 0}}},g=this,h=0;h<this._linkMatchers.length;h++){var k=a(h);if("object"===typeof k)return k.value}};c.prototype._doLinkifyRow=function(b,a,c,f){for(var h=
this._rows[b].childNodes,k=0;k<h.length;k++){var b=h[k],g=b.textContent.indexOf(a);if(0<=g){c=this._createAnchorElement(a,c,f);if(b.textContent.length===a.length)if(3===b.nodeType)this._replaceNode(b,c);else{a=b;if("A"===a.nodeName)break;a.innerHTML="";a.appendChild(c)}else this._replaceNodeSubstringWithNode(b,c,a,g);return c}}};c.prototype._findLinkMatch=function(b,a,c){b=b.match(a);return!b||0===b.length?null:b["number"!==typeof c?0:c]};c.prototype._createAnchorElement=function(b,a,c){var f=this._document.createElement("a");
f.textContent=b;c?(f.href=b,f.target="_blank",f.addEventListener("click",function(h){if(a)return a(h,b)})):f.addEventListener("click",function(h){return f.classList.contains("xterm-invalid-link")?void 0:a(h,b)});return f};c.prototype._replaceNode=function(b){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];for(var c=b.parentNode,f=0;f<a.length;f++)c.insertBefore(a[f],b);c.removeChild(b)};c.prototype._replaceNodeSubstringWithNode=function(b,a,c,f){var h=b;3!==h.nodeType&&(h=h.childNodes[0]);
if(0===h.childNodes.length&&h.nodeType!==Node.TEXT_NODE)throw Error("targetNode must be a text node or only contain a single text node");var k=h.textContent;0===f?(c=k.substring(c.length),c=this._document.createTextNode(c),this._replaceNode(h,a,c)):f===b.textContent.length-c.length?(b=k.substring(0,f),b=this._document.createTextNode(b),this._replaceNode(h,b,a)):(b=k.substring(0,f),b=this._document.createTextNode(b),c=k.substring(f+c.length),c=this._document.createTextNode(c),this._replaceNode(h,b,
a,c))};return c}();g.TIME_BEFORE_LINKIFY=200;i.Linkifier=g},{}],7:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});var b=g("./EscapeSequences"),f=g("./Charsets"),c={};c[b.C0.BEL]=function(a,b){return b.bell()};c[b.C0.LF]=function(a,b){return b.lineFeed()};c[b.C0.VT]=c[b.C0.LF];c[b.C0.FF]=c[b.C0.LF];c[b.C0.CR]=function(a,b){return b.carriageReturn()};c[b.C0.BS]=function(a,b){return b.backspace()};c[b.C0.HT]=function(a,b){return b.tab()};c[b.C0.SO]=function(a,b){return b.shiftOut()};
c[b.C0.SI]=function(a,b){return b.shiftIn()};c[b.C0.ESC]=function(a){return a.setState(j.ESCAPED)};var d={"[":function(a,b){b.params=[];b.currentParam=0;a.setState(j.CSI_PARAM)},"]":function(a,b){b.params=[];b.currentParam=0;a.setState(j.OSC)},P:function(a,b){b.params=[];b.currentParam=0;a.setState(j.DCS)},_:function(a){a.setState(j.IGNORE)},"^":function(a){a.setState(j.IGNORE)},c:function(a,b){b.reset()},E:function(a,b){b.x=0;b.index();a.setState(j.NORMAL)},D:function(a,b){b.index();a.setState(j.NORMAL)},
M:function(a,b){b.reverseIndex();a.setState(j.NORMAL)},"%":function(a,b){b.setgLevel(0);b.setgCharset(0,f.DEFAULT_CHARSET);a.setState(j.NORMAL);a.skipNextChar()}};d[b.C0.CAN]=function(a){return a.setState(j.NORMAL)};var a={"?":function(a){return a.setPrefix("?")},">":function(a){return a.setPrefix(">")},"!":function(a){return a.setPrefix("!")},"0":function(a){return a.setParam(10*a.getParam())},1:function(a){return a.setParam(10*a.getParam()+1)},2:function(a){return a.setParam(10*a.getParam()+2)},
3:function(a){return a.setParam(10*a.getParam()+3)},4:function(a){return a.setParam(10*a.getParam()+4)},5:function(a){return a.setParam(10*a.getParam()+5)},6:function(a){return a.setParam(10*a.getParam()+6)},7:function(a){return a.setParam(10*a.getParam()+7)},8:function(a){return a.setParam(10*a.getParam()+8)},9:function(a){return a.setParam(10*a.getParam()+9)},$:function(a){return a.setPostfix("$")},'"':function(a){return a.setPostfix('"')}," ":function(a){return a.setPostfix(" ")},"'":function(a){return a.setPostfix("'")},
";":function(a){return a.finalizeParam()}};a[b.C0.CAN]=function(a){return a.setState(j.NORMAL)};var o={"@":function(a,b){return a.insertChars(b)},A:function(a,b){return a.cursorUp(b)},B:function(a,b){return a.cursorDown(b)},C:function(a,b){return a.cursorForward(b)},D:function(a,b){return a.cursorBackward(b)},E:function(a,b){return a.cursorNextLine(b)},F:function(a,b){return a.cursorPrecedingLine(b)},G:function(a,b){return a.cursorCharAbsolute(b)},H:function(a,b){return a.cursorPosition(b)},I:function(a,
b){return a.cursorForwardTab(b)},J:function(a,b){return a.eraseInDisplay(b)},K:function(a,b){return a.eraseInLine(b)},L:function(a,b){return a.insertLines(b)},M:function(a,b){return a.deleteLines(b)},P:function(a,b){return a.deleteChars(b)},S:function(a,b){return a.scrollUp(b)},T:function(a,b,d){2>b.length&&!d&&a.scrollDown(b)},X:function(a,b){return a.eraseChars(b)},Z:function(a,b){return a.cursorBackwardTab(b)},"`":function(a,b){return a.charPosAbsolute(b)},a:function(a,b){return a.HPositionRelative(b)},
b:function(a,b){return a.repeatPrecedingCharacter(b)},c:function(a,b){return a.sendDeviceAttributes(b)},d:function(a,b){return a.linePosAbsolute(b)},e:function(a,b){return a.VPositionRelative(b)},f:function(a,b){return a.HVPosition(b)},g:function(a,b){return a.tabClear(b)},h:function(a,b){return a.setMode(b)},l:function(a,b){return a.resetMode(b)},m:function(a,b){return a.charAttributes(b)},n:function(a,b){return a.deviceStatus(b)},p:function(a,b,d){switch(d){case "!":a.softReset(b)}},q:function(a,
b,d,c){" "===c&&a.setCursorStyle(b)},r:function(a,b){return a.setScrollRegion(b)},s:function(a,b){return a.saveCursor(b)},u:function(a,b){return a.restoreCursor(b)}};o[b.C0.CAN]=function(a,b,d,c,f){return f.setState(j.NORMAL)};var j;(function(a){a[a.NORMAL=0]="NORMAL";a[a.ESCAPED=1]="ESCAPED";a[a.CSI_PARAM=2]="CSI_PARAM";a[a.CSI=3]="CSI";a[a.OSC=4]="OSC";a[a.CHARSET=5]="CHARSET";a[a.DCS=6]="DCS";a[a.IGNORE=7]="IGNORE"})(j||(j={}));g=function(){function h(a,b){this._inputHandler=a;this._terminal=b;
this._state=j.NORMAL}h.prototype.parse=function(h){var g=h.length,i,e,l;this._position=0;this._terminal.surrogate_high&&(h=this._terminal.surrogate_high+h,this._terminal.surrogate_high="");for(;this._position<g;this._position++){e=h[this._position];i=h.charCodeAt(this._position);if(55296<=i&&56319>=i){l=h.charCodeAt(this._position+1);if(isNaN(l)){this._terminal.surrogate_high=e;continue}i=1024*(i-55296)+(l-56320)+65536;e+=h.charAt(this._position+1)}if(!(56320<=i&&57343>=i))switch(this._state){case j.NORMAL:if(e in
c)c[e](this,this._inputHandler);else this._inputHandler.addChar(e,i);break;case j.ESCAPED:if(e in d){d[e](this,this._terminal);break}switch(e){case "(":case ")":case "*":case "+":case "-":case ".":switch(e){case "(":this._terminal.gcharset=0;break;case ")":this._terminal.gcharset=1;break;case "*":this._terminal.gcharset=2;break;case "+":this._terminal.gcharset=3;break;case "-":this._terminal.gcharset=1;break;case ".":this._terminal.gcharset=2}this._state=j.CHARSET;break;case "/":this._terminal.gcharset=
3;this._state=j.CHARSET;this._position--;break;case "N":break;case "O":break;case "n":this._terminal.setgLevel(2);break;case "o":this._terminal.setgLevel(3);break;case "|":this._terminal.setgLevel(3);break;case "}":this._terminal.setgLevel(2);break;case "~":this._terminal.setgLevel(1);break;case "7":this._inputHandler.saveCursor();this._state=j.NORMAL;break;case "8":this._inputHandler.restoreCursor();this._state=j.NORMAL;break;case "#":this._state=j.NORMAL;this._position++;break;case "H":this._terminal.tabSet();
this._state=j.NORMAL;break;case "=":this._terminal.log("Serial port requested application keypad.");this._terminal.applicationKeypad=!0;this._terminal.viewport.syncScrollArea();this._state=j.NORMAL;break;case ">":this._terminal.log("Switching back to normal keypad.");this._terminal.applicationKeypad=!1;this._terminal.viewport.syncScrollArea();this._state=j.NORMAL;break;default:this._state=j.NORMAL,this._terminal.error("Unknown ESC control: %s.",e)}break;case j.CHARSET:e in f.CHARSETS?(i=f.CHARSETS[e],
"/"===e&&this.skipNextChar()):i=f.DEFAULT_CHARSET;this._terminal.setgCharset(this._terminal.gcharset,i);this._terminal.gcharset=null;this._state=j.NORMAL;break;case j.OSC:if(e===b.C0.ESC||e===b.C0.BEL){e===b.C0.ESC&&this._position++;this._terminal.params.push(this._terminal.currentParam);switch(this._terminal.params[0]){case 0:case 1:case 2:this._terminal.params[1]&&(this._terminal.title=this._terminal.params[1],this._terminal.handleTitle(this._terminal.title))}this._terminal.params=[];this._terminal.currentParam=
0;this._state=j.NORMAL}else this._terminal.params.length?this._terminal.currentParam+=e:"0"<=e&&"9">=e?this._terminal.currentParam=10*this._terminal.currentParam+e.charCodeAt(0)-48:";"===e&&(this._terminal.params.push(this._terminal.currentParam),this._terminal.currentParam="");break;case j.CSI_PARAM:if(e in a){a[e](this);break}this.finalizeParam();this._state=j.CSI;case j.CSI:if(e in o)o[e](this._inputHandler,this._terminal.params,this._terminal.prefix,this._terminal.postfix,this);else this._terminal.error("Unknown CSI code: %s.",
e);this._state=j.NORMAL;this._terminal.prefix="";this._terminal.postfix="";break;case j.DCS:if(e===b.C0.ESC||e===b.C0.BEL){e===b.C0.ESC&&this._position++;switch(this._terminal.prefix){case "":break;case "$q":e=this._terminal.currentParam;i=!1;switch(e){case '"q':e='0"q';break;case '"p':e='61"p';break;case "r":e=""+(this._terminal.scrollTop+1)+";"+(this._terminal.scrollBottom+1)+"r";break;case "m":e="0m";break;default:this._terminal.error("Unknown DCS Pt: %s.",e),e=""}this._terminal.send(b.C0.ESC+
"P"+ +i+"$r"+e+b.C0.ESC+"\\");break;case "+p":break;case "+q":e=this._terminal.currentParam;i=!1;this._terminal.send(b.C0.ESC+"P"+ +i+"+r"+e+b.C0.ESC+"\\");break;default:this._terminal.error("Unknown DCS prefix: %s.",this._terminal.prefix)}this._terminal.currentParam=0;this._terminal.prefix="";this._state=j.NORMAL}else this._terminal.currentParam?this._terminal.currentParam+=e:!this._terminal.prefix&&"$"!==e&&"+"!==e?this._terminal.currentParam=e:2===this._terminal.prefix.length?this._terminal.currentParam=
e:this._terminal.prefix+=e;break;case j.IGNORE:if(e===b.C0.ESC||e===b.C0.BEL)e===b.C0.ESC&&this._position++,this._state=j.NORMAL}}};h.prototype.setState=function(a){this._state=a};h.prototype.setPrefix=function(a){this._terminal.prefix=a};h.prototype.setPostfix=function(a){this._terminal.postfix=a};h.prototype.setParam=function(a){this._terminal.currentParam=a};h.prototype.getParam=function(){return this._terminal.currentParam};h.prototype.finalizeParam=function(){this._terminal.params.push(this._terminal.currentParam);
this._terminal.currentParam=0};h.prototype.skipNextChar=function(){this._position++};return h}();i.Parser=g},{"./Charsets":1,"./EscapeSequences":3}],8:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});var b;(function(b){b[b.BOLD=1]="BOLD";b[b.UNDERLINE=2]="UNDERLINE";b[b.BLINK=4]="BLINK";b[b.INVERSE=8]="INVERSE";b[b.INVISIBLE=16]="INVISIBLE"})(b||(b={}));var f=null,g=function(){function c(b){this._terminal=b;this._refreshRowsQueue=[];this._refreshFramesSkipped=0;this._refreshAnimationFrame=
null;if(null===f){var a=this._terminal.document,b=a.getElementsByTagName("body")[0],a=a.createElement("span");a.innerHTML="hello world";b.appendChild(a);var c=a.scrollWidth;a.style.fontWeight="bold";var g=a.scrollWidth;b.removeChild(a);f=c!==g}}c.prototype.queueRefresh=function(b,a){this._refreshRowsQueue.push({start:b,end:a});this._refreshAnimationFrame||(this._refreshAnimationFrame=window.requestAnimationFrame(this._refreshLoop.bind(this)))};c.prototype._refreshLoop=function(){if(0<this._terminal.writeBuffer.length&&
5>=this._refreshFramesSkipped++)this._refreshAnimationFrame=window.requestAnimationFrame(this._refreshLoop.bind(this));else{this._refreshFramesSkipped=0;var b,a;if(4<this._refreshRowsQueue.length)b=0,a=this._terminal.rows-1;else{b=this._refreshRowsQueue[0].start;a=this._refreshRowsQueue[0].end;for(var c=1;c<this._refreshRowsQueue.length;c++)this._refreshRowsQueue[c].start<b&&(b=this._refreshRowsQueue[c].start),this._refreshRowsQueue[c].end>a&&(a=this._refreshRowsQueue[c].end)}this._refreshRowsQueue=
[];this._refreshAnimationFrame=null;this._refresh(b,a)}};c.prototype._refresh=function(c,a){var g,i,h,k,m,l,e,v,r,q,p,s,w;a-c>=this._terminal.rows/2&&(w=this._terminal.element.parentNode)&&this._terminal.element.removeChild(this._terminal.rowContainer);v=this._terminal.cols;i=c;a>=this._terminal.rows&&(this._terminal.log("`end` is too large. Most likely a bad CSR."),a=this._terminal.rows-1);for(;i<=a;i++)if(g=i+this._terminal.ydisp,(k=this._terminal.lines.get(g))&&this._terminal.children[i]){m="";
g=this._terminal.y===i-(this._terminal.ybase-this._terminal.ydisp)&&this._terminal.cursorState&&!this._terminal.cursorHidden?this._terminal.x:-1;q=this._terminal.defAttr;for(h=0;h<v;h++)if(k[h]&&(r=k[h][0],l=k[h][1],e=k[h][2])){h===g&&(r=-1);if(r!==q&&(q!==this._terminal.defAttr&&(m+="</span>"),r!==this._terminal.defAttr))if(-1===r)m+='<span class="reverse-video terminal-cursor">';else{var n=[];q=r&511;p=r>>9&511;s=r>>18;s&b.BOLD&&(f||n.push("xterm-bold"),8>p&&(p+=8));s&b.UNDERLINE&&n.push("xterm-underline");
s&b.BLINK&&n.push("xterm-blink");s&b.INVERSE&&(q=p,s&1&&8>p&&(p+=8));s&b.INVISIBLE&&n.push("xterm-hidden");s&b.INVERSE&&(257===q&&(q=15),256===p&&(p=0));256>q&&n.push("xterm-bg-color-"+q);256>p&&n.push("xterm-color-"+p);m+="<span";n.length&&(m+=' class="'+n.join(" ")+'"');m+=">"}2===e&&(m+='<span class="xterm-wide-char">');switch(l){case "&":m+="&amp;";break;case "<":m+="&lt;";break;case ">":m+="&gt;";break;default:m=" ">=l?m+"&nbsp;":m+l}2===e&&(m+="</span>");q=r}q!==this._terminal.defAttr&&(m+=
"</span>");this._terminal.children[i].innerHTML=m}w&&this._terminal.element.appendChild(this._terminal.rowContainer);this._terminal.emit("refresh",{element:this._terminal.element,start:c,end:a})};return c}();i.Renderer=g},{}],9:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});g=function(){function b(b,c,d,a){var g=this;this.terminal=b;this.viewportElement=c;this.scrollArea=d;this.charMeasure=a;this.lastRecordedViewportHeight=this.lastRecordedBufferLength=this.currentRowHeight=0;this.terminal.on("scroll",
this.syncScrollArea.bind(this));this.terminal.on("resize",this.syncScrollArea.bind(this));this.viewportElement.addEventListener("scroll",this.onScroll.bind(this));setTimeout(function(){return g.syncScrollArea()},0)}b.prototype.refresh=function(){if(0<this.charMeasure.height){var b=this.charMeasure.height!==this.currentRowHeight;b&&(this.currentRowHeight=this.charMeasure.height,this.viewportElement.style.lineHeight=this.charMeasure.height+"px",this.terminal.rowContainer.style.lineHeight=this.charMeasure.height+
"px");var c=this.lastRecordedViewportHeight!==this.terminal.rows;if(b||c)this.lastRecordedViewportHeight=this.terminal.rows,this.viewportElement.style.height=this.charMeasure.height*this.terminal.rows+"px";this.scrollArea.style.height=this.charMeasure.height*this.lastRecordedBufferLength+"px"}};b.prototype.syncScrollArea=function(){this.lastRecordedBufferLength!==this.terminal.lines.length?(this.lastRecordedBufferLength=this.terminal.lines.length,this.refresh()):this.lastRecordedViewportHeight!==
this.terminal.rows?this.refresh():this.charMeasure.height!==this.currentRowHeight&&this.refresh();var b=this.terminal.ydisp*this.currentRowHeight;this.viewportElement.scrollTop!==b&&(this.viewportElement.scrollTop=b)};b.prototype.onScroll=function(){this.terminal.scrollDisp(Math.round(this.viewportElement.scrollTop/this.currentRowHeight)-this.terminal.ydisp,!0)};b.prototype.onWheel=function(b){if(0!==b.deltaY){var c=1;b.deltaMode===WheelEvent.DOM_DELTA_LINE?c=this.currentRowHeight:b.deltaMode===WheelEvent.DOM_DELTA_PAGE&&
(c=this.currentRowHeight*this.terminal.rows);this.viewportElement.scrollTop+=b.deltaY*c;b.preventDefault()}};return b}();i.Viewport=g},{}],10:[function(g,l,i){function b(b){var c=String.fromCharCode(32),d=String.fromCharCode(160),a=RegExp(d,"g");return b.split("\n").map(function(b){return b.replace(/\s+$/g,"").replace(a,c)}).join("\n")}Object.defineProperty(i,"__esModule",{value:!0});i.prepareTextForClipboard=b;i.copyHandler=function(f,c){var d=window.getSelection().toString(),d=b(d);c.browser.isMSIE?
window.clipboardData.setData("Text",d):f.clipboardData.setData("text/plain",d);f.preventDefault()};i.pasteHandler=function(b,c){b.stopPropagation();var d,a=function(a){c.handler(a);c.textarea.value="";return c.cancel(b)};c.browser.isMSIE?window.clipboardData&&(d=window.clipboardData.getData("Text"),a(d)):b.clipboardData&&(d=b.clipboardData.getData("text/plain"),a(d))};i.rightClickHandler=function(f,c){var d=document.getSelection(),a=b(d.toString()),g=!1,i=f.clientX,h=f.clientY;if(d.rangeCount){for(var d=
d.getRangeAt(0).getClientRects(),k=0;k<d.length&&!(g=d[k],g=i>g.left&&i<g.right&&h>g.top&&h<g.bottom);k++);if(a.match(/^\s$/)||!a.length)g=!1}g||(c.textarea.style.position="fixed",c.textarea.style.width="20px",c.textarea.style.height="20px",c.textarea.style.left=i-10+"px",c.textarea.style.top=h-10+"px",c.textarea.style.zIndex="1000",c.textarea.focus(),setTimeout(function(){c.textarea.style.position=null;c.textarea.style.width=null;c.textarea.style.height=null;c.textarea.style.left=null;c.textarea.style.top=
null;c.textarea.style.zIndex=null},4))}},{}],11:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});var g=g("./Generic"),b="undefined"===typeof navigator?!0:!1,l=b?"node":navigator.userAgent,b=b?"node":navigator.platform;i.isFirefox=!!~l.indexOf("Firefox");i.isMSIE=!!~l.indexOf("MSIE")||!!~l.indexOf("Trident");i.isMac=g.contains(["Macintosh","MacIntel","MacPPC","Mac68K"],b);i.isIpad="iPad"===b;i.isIphone="iPhone"===b;i.isMSWindows=g.contains(["Windows","Win16","Win32","WinCE"],b)},{"./Generic":14}],
12:[function(g,l,i){var b=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,d){b.__proto__=d}||function(b,d){for(var a in d)d.hasOwnProperty(a)&&(b[a]=d[a])};return function(c,d){function a(){this.constructor=c}b(c,d);c.prototype=null===d?Object.create(d):(a.prototype=d.prototype,new a)}}();Object.defineProperty(i,"__esModule",{value:!0});g=function(f){function c(b,a){var c=f.call(this)||this;c._document=b;c._parentElement=a;return c}b(c,f);Object.defineProperty(c.prototype,
"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});c.prototype.measure=function(){var b=this;this._measureElement?this._doMeasure():(this._measureElement=this._document.createElement("span"),this._measureElement.style.position="absolute",this._measureElement.style.top="0",this._measureElement.style.left="-9999em",this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden",
"true"),this._parentElement.appendChild(this._measureElement),setTimeout(function(){return b._doMeasure()},0))};c.prototype._doMeasure=function(){var b=this._measureElement.getBoundingClientRect();if(!(0===b.width||0===b.height))if(this._width!==b.width||this._height!==b.height)this._width=b.width,this._height=b.height,this.emit("charsizechanged")};return c}(g("../EventEmitter.js").EventEmitter);i.CharMeasure=g},{"../EventEmitter.js":4}],13:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});
g=function(){function b(b){this._array=Array(b);this._length=this._startIndex=0}Object.defineProperty(b.prototype,"maxLength",{get:function(){return this._array.length},set:function(b){for(var c=Array(b),d=0;d<Math.min(b,this.length);d++)c[d]=this._array[this._getCyclicIndex(d)];this._array=c;this._startIndex=0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"length",{get:function(){return this._length},set:function(b){if(b>this._length)for(var c=this._length;c<b;c++)this._array[c]=
void 0;this._length=b},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"forEach",{get:function(){return this._array.forEach},enumerable:!0,configurable:!0});b.prototype.get=function(b){return this._array[this._getCyclicIndex(b)]};b.prototype.set=function(b,c){this._array[this._getCyclicIndex(b)]=c};b.prototype.push=function(b){this._array[this._getCyclicIndex(this._length)]=b;this._length===this.maxLength?(this._startIndex++,this._startIndex===this.maxLength&&(this._startIndex=0)):
this._length++};b.prototype.pop=function(){return this._array[this._getCyclicIndex(this._length-- -1)]};b.prototype.splice=function(b,c){for(var d=[],a=2;a<arguments.length;a++)d[a-2]=arguments[a];if(c){for(a=b;a<this._length-c;a++)this._array[this._getCyclicIndex(a)]=this._array[this._getCyclicIndex(a+c)];this._length-=c}if(d&&d.length){for(a=this._length-1;a>=b;a--)this._array[this._getCyclicIndex(a+d.length)]=this._array[this._getCyclicIndex(a)];for(a=0;a<d.length;a++)this._array[this._getCyclicIndex(b+
a)]=d[a];this._length+d.length>this.maxLength?(this._startIndex+=this._length+d.length-this.maxLength,this._length=this.maxLength):this._length+=d.length}};b.prototype.trimStart=function(b){b>this._length&&(b=this._length);this._startIndex+=b;this._length-=b};b.prototype.shiftElements=function(b,c,d){if(!(0>=c)){if(0>b||b>=this._length)throw Error("start argument out of range");if(0>b+d)throw Error("Cannot shift elements in list beyond index 0");if(0<d){for(var a=c-1;0<=a;a--)this.set(b+a+d,this.get(b+
a));b=b+c+d-this._length;if(0<b)for(this._length+=b;this._length>this.maxLength;)this._length--,this._startIndex++}else for(a=0;a<c;a++)this.set(b+a+d,this.get(b+a))}};b.prototype._getCyclicIndex=function(b){return(this._startIndex+b)%this.maxLength};return b}();i.CircularList=g},{}],14:[function(g,l,i){Object.defineProperty(i,"__esModule",{value:!0});i.contains=function(b,f){return 0<=b.indexOf(f)}},{}],15:[function(g,l,i){function b(a,c,d){var e=this;if(!(this instanceof b))return new b(a,c,d);
e.browser=w;e.cancel=b.cancel;h.EventEmitter.call(this);"number"===typeof a&&(a={cols:a,rows:c,handler:d});a=a||{};Object.keys(b.defaults).forEach(function(c){null==a[c]&&(a[c]=b.options[c],b[c]!==b.defaults[c]&&(a[c]=b[c]));e[c]=a[c]});8===a.colors.length?a.colors=a.colors.concat(b._colors.slice(8)):16===a.colors.length?a.colors=a.colors.concat(b._colors.slice(16)):10===a.colors.length?a.colors=a.colors.slice(0,-2).concat(b._colors.slice(8,-2),a.colors.slice(-2)):18===a.colors.length&&(a.colors=
a.colors.concat(b._colors.slice(16,-2),a.colors.slice(-2)));this.colors=a.colors;this.options=a;this.parent=a.body||a.parent||(n?n.getElementsByTagName("body")[0]:null);this.cols=a.cols||a.geometry[0];this.rows=a.rows||a.geometry[1];this.geometry=[this.cols,this.rows];if(a.handler)this.on("data",a.handler);this.cursorState=this.y=this.x=this.ydisp=this.ybase=0;this.cursorHidden=!1;this.convertEol;this.queue="";this.scrollTop=0;this.scrollBottom=this.rows-1;this.customKeydownHandler=null;this.insertMode=
this.originMode=this.applicationCursor=this.applicationKeypad=!1;this.wraparoundMode=!0;this.gcharset=this.charset=this.normal=null;this.glevel=0;this.charsets=[null];this.decLocator;this.x10Mouse;this.vt200Mouse;this.vt300Mouse;this.normalMouse;this.mouseEvents;this.sendFocus;this.utfMouse;this.sgrMouse;this.urxvtMouse;this.element;this.children;this.refreshStart;this.refreshEnd;this.savedX;this.savedY;this.savedCols;this.writable=this.readable=!0;this.curAttr=this.defAttr=131840;this.params=[];
this.currentParam=0;this.postfix=this.prefix="";this.inputHandler=new v.InputHandler(this);this.parser=new r.Parser(this.inputHandler,this);this.renderer=this.renderer||null;this.linkifier=this.linkifier||null;this.writeBuffer=[];this.writeStopped=this.xoffSentToCatchUp=this.writeInProgress=!1;this.surrogate_high="";this.lines=new z.CircularList(this.scrollback);for(c=this.rows;c--;)this.lines.push(this.blankLine());this.tabs;this.setupStops();this.userScrolling=!1}function f(a,b,c,d){Array.isArray(a)||
(a=[a]);a.forEach(function(a){a.addEventListener(b,c,d||!1)})}function c(a,b,c,d){a.removeEventListener(b,c,d||!1)}function d(a,b){function c(){this.constructor=a}c.prototype=b.prototype;a.prototype=new c}function a(a,b){var c=a.browser.isMac&&b.altKey&&!b.ctrlKey&&!b.metaKey||a.browser.isMSWindows&&b.altKey&&b.ctrlKey&&!b.metaKey;return"keypress"==b.type?c:c&&(!b.keyCode||47<b.keyCode)}function o(a,c,d){var e=a<<16|c<<8|d;if(null!=o._cache[e])return o._cache[e];for(var f=Infinity,g=-1,h=0,i,u,y;h<
b.vcolors.length;h++){i=b.vcolors[h];u=i[0];y=i[1];i=i[2];u=o.distance(a,c,d,u,y,i);if(0===u){g=h;break}u<f&&(f=u,g=h)}return o._cache[e]=g}Object.defineProperty(i,"__esModule",{value:!0});var j=g("./CompositionHelper"),h=g("./EventEmitter"),k=g("./Viewport"),m=g("./handlers/Clipboard"),z=g("./utils/CircularList"),e=g("./EscapeSequences"),v=g("./InputHandler"),r=g("./Parser"),q=g("./Renderer"),p=g("./Linkifier"),s=g("./utils/CharMeasure"),w=g("./utils/Browser"),n="undefined"!=typeof window?window.document:
null;d(b,h.EventEmitter);b.prototype.eraseAttr=function(){return this.defAttr&-512|this.curAttr&511};b.tangoColors="#2e3436,#cc0000,#4e9a06,#c4a000,#3465a4,#75507b,#06989a,#d3d7cf,#555753,#ef2929,#8ae234,#fce94f,#729fcf,#ad7fa8,#34e2e2,#eeeeec".split(",");b.colors=function(){function a(b,t,e){d.push("#"+c(b)+c(t)+c(e))}function c(a){a=a.toString(16);return 2>a.length?"0"+a:a}var d=b.tangoColors.slice(),e=[0,95,135,175,215,255],f;for(f=0;216>f;f++)a(e[f/36%6|0],e[f/6%6|0],e[f%6]);for(f=0;24>f;f++)e=
8+10*f,a(e,e,e);return d}();b._colors=b.colors.slice();b.vcolors=function(){for(var a=[],c=b.colors,d=0,e;256>d;d++)e=parseInt(c[d].substring(1),16),a.push([e>>16&255,e>>8&255,e&255]);return a}();b.defaults={colors:b.colors,theme:"default",convertEol:!1,termName:"xterm",geometry:[80,24],cursorBlink:!1,cursorStyle:"block",visualBell:!1,popOnBell:!1,scrollback:1E3,screenKeys:!1,debug:!1,cancelEvents:!1,disableStdin:!1,useFlowControl:!1,tabStopWidth:8};b.options={};b.focus=null;(function(a,b,c){if(a.forEach)return a.forEach(b,
c);for(var d=0;d<a.length;d++)b.call(c,a[d],d,a)})(function(a){if(Object.keys)return Object.keys(a);var b,c=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c}(b.defaults),function(a){b[a]=b.defaults[a];b.options[a]=b.defaults[a]});b.prototype.focus=function(){return this.textarea.focus()};b.prototype.getOption=function(a){if(!(a in b.defaults))throw Error('No option with key "'+a+'"');return"undefined"!==typeof this.options[a]?this.options[a]:this[a]};b.prototype.setOption=
function(a,c){if(!(a in b.defaults))throw Error('No option with key "'+a+'"');switch(a){case "scrollback":if(this.options[a]!==c){if(this.lines.length>c){var d=this.lines.length-c,e=0>this.ydisp-d;this.lines.trimStart(d);this.ybase=Math.max(this.ybase-d,0);this.ydisp=Math.max(this.ydisp-d,0);e&&this.refresh(0,this.rows-1)}this.lines.maxLength=c;this.viewport.syncScrollArea()}}this[a]=c;this.options[a]=c;switch(a){case "cursorBlink":this.element.classList.toggle("xterm-cursor-blink",c);break;case "cursorStyle":this.element.classList.toggle("xterm-cursor-style-underline",
"underline"===c);this.element.classList.toggle("xterm-cursor-style-bar","bar"===c);break;case "tabStopWidth":this.setupStops()}};b.bindFocus=function(a){f(a.textarea,"focus",function(){a.sendFocus&&a.send(e.C0.ESC+"[I");a.element.classList.add("focus");a.showCursor();b.focus=a;a.emit("focus",{terminal:a})})};b.prototype.blur=function(){return this.textarea.blur()};b.bindBlur=function(a){f(a.textarea,"blur",function(){a.refresh(a.y,a.y);a.sendFocus&&a.send(e.C0.ESC+"[O");a.element.classList.remove("focus");
b.focus=null;a.emit("blur",{terminal:a})})};b.prototype.initGlobal=function(){function a(b){m.rightClickHandler.call(this,b,c)}var c=this;b.bindKeys(this);b.bindFocus(this);b.bindBlur(this);f(this.element,"copy",function(a){m.copyHandler.call(this,a,c)});f(this.textarea,"paste",function(a){m.pasteHandler.call(this,a,c)});f(this.element,"paste",function(a){m.pasteHandler.call(this,a,c)});c.browser.isFirefox?f(this.element,"mousedown",function(b){2==b.button&&a(b)}):f(this.element,"contextmenu",a)};
b.bindKeys=function(a){f(a.element,"keydown",function(b){n.activeElement==this&&a.keyDown(b)},!0);f(a.element,"keypress",function(b){n.activeElement==this&&a.keyPress(b)},!0);f(a.element,"keyup",function(b){16===b.keyCode||17===b.keyCode||18===b.keyCode||a.focus(a)},!0);f(a.textarea,"keydown",function(b){a.keyDown(b)},!0);f(a.textarea,"keypress",function(b){a.keyPress(b);this.value=""},!0);f(a.textarea,"compositionstart",a.compositionHelper.compositionstart.bind(a.compositionHelper));f(a.textarea,
"compositionupdate",a.compositionHelper.compositionupdate.bind(a.compositionHelper));f(a.textarea,"compositionend",a.compositionHelper.compositionend.bind(a.compositionHelper));a.on("refresh",a.compositionHelper.updateCompositionElements.bind(a.compositionHelper));a.on("refresh",function(b){a.queueLinkification(b.start,b.end)})};b.prototype.insertRow=function(a){"object"!=typeof a&&(a=n.createElement("div"));this.rowContainer.appendChild(a);this.children.push(a);return a};b.prototype.open=function(a){var b=
this,c=0;this.parent=a||this.parent;if(!this.parent)throw Error("Terminal requires a parent element.");this.context=this.parent.ownerDocument.defaultView;this.document=this.parent.ownerDocument;this.body=this.document.getElementsByTagName("body")[0];this.element=this.document.createElement("div");this.element.classList.add("terminal");this.element.classList.add("xterm");this.element.classList.add("xterm-theme-"+this.theme);this.element.classList.toggle("xterm-cursor-blink",this.options.cursorBlink);
this.element.style.height;this.element.setAttribute("tabindex",0);this.viewportElement=n.createElement("div");this.viewportElement.classList.add("xterm-viewport");this.element.appendChild(this.viewportElement);this.viewportScrollArea=n.createElement("div");this.viewportScrollArea.classList.add("xterm-scroll-area");this.viewportElement.appendChild(this.viewportScrollArea);this.rowContainer=n.createElement("div");this.rowContainer.classList.add("xterm-rows");this.element.appendChild(this.rowContainer);
this.children=[];this.linkifier=new p.Linkifier(n,this.children);this.helperContainer=n.createElement("div");this.helperContainer.classList.add("xterm-helpers");this.element.appendChild(this.helperContainer);this.textarea=n.createElement("textarea");this.textarea.classList.add("xterm-helper-textarea");this.textarea.setAttribute("autocorrect","off");this.textarea.setAttribute("autocapitalize","off");this.textarea.setAttribute("spellcheck","false");this.textarea.tabIndex=0;this.textarea.addEventListener("focus",
function(){b.emit("focus",{terminal:b})});this.textarea.addEventListener("blur",function(){b.emit("blur",{terminal:b})});this.helperContainer.appendChild(this.textarea);this.compositionView=n.createElement("div");this.compositionView.classList.add("composition-view");this.compositionHelper=new j.CompositionHelper(this.textarea,this.compositionView,this);this.helperContainer.appendChild(this.compositionView);this.charSizeStyleElement=n.createElement("style");for(this.helperContainer.appendChild(this.charSizeStyleElement);c<
this.rows;c++)this.insertRow();this.parent.appendChild(this.element);this.charMeasure=new s.CharMeasure(n,this.helperContainer);this.charMeasure.on("charsizechanged",function(){b.updateCharSizeCSS()});this.charMeasure.measure();this.viewport=new k.Viewport(this,this.viewportElement,this.viewportScrollArea,this.charMeasure);this.renderer=new q.Renderer(this);this.refresh(0,this.rows-1);this.initGlobal();this.focus();f(this.element,"click",function(){var a=n.getSelection(),c=a.isCollapsed;("boolean"==
typeof c?!c:"Range"==a.type)||b.focus()});this.bindMouse();this.emit("open")};b.loadAddon=function(a){if("object"===typeof i&&"object"===typeof l)return g("./addons/"+a+"/"+a);console.error("Cannot load a module without a CommonJS or RequireJS environment.");return!1};b.prototype.updateCharSizeCSS=function(){this.charSizeStyleElement.textContent=".xterm-wide-char{width:"+2*this.charMeasure.width+"px;}"};b.prototype.bindMouse=function(){function a(b){var c,d,t,e;switch(b.overrideType||b.type){case "mousedown":c=
null!=b.button?+b.button:null!=b.which?b.which-1:null;j.browser.isMSIE&&(c=1===c?0:4===c?1:c);break;case "mouseup":c=3;break;case "DOMMouseScroll":c=0>b.detail?64:65;break;case "wheel":c=0<b.wheelDeltaY?64:65}t=b.shiftKey?4:0;e=b.metaKey?8:0;d=b.ctrlKey?16:0;t=t|e|d;j.vt200Mouse?t&=d:j.normalMouse||(t=0);c=32+(t<<2)+c;if(d=h(b))switch(g(c,d),b.overrideType||b.type){case "mousedown":k=c;break;case "mouseup":k=32}}function b(a){var c=k;(a=h(a))&&g(c+32,a)}function d(a,b){if(j.utfMouse){if(2047===b)return a.push(0);
127>b?a.push(b):(2047<b&&(b=2047),a.push(192|b>>6),a.push(128|b&63))}else{if(255===b)return a.push(0);127<b&&(b=127);a.push(b)}}function g(a,b){if(j.vt300Mouse){a&=3;b.x-=32;b.y-=32;var c=e.C0.ESC+"[24";if(0===a)c+="1";else if(1===a)c+="3";else if(2===a)c+="5";else{if(3===a)return;c+="0"}c+="~["+b.x+","+b.y+"]\r";j.send(c)}else j.decLocator?(a&=3,b.x-=32,b.y-=32,0===a?a=2:1===a?a=4:2===a?a=6:3===a&&(a=3),j.send(e.C0.ESC+"["+a+";"+(3===a?4:0)+";"+b.y+";"+b.x+";"+(b.page||0)+"&w")):j.urxvtMouse?(b.x-=
32,b.y-=32,b.x++,b.y++,j.send(e.C0.ESC+"["+a+";"+b.x+";"+b.y+"M")):j.sgrMouse?(b.x-=32,b.y-=32,j.send(e.C0.ESC+"[<"+((3===(a&3)?a&-4:a)-32)+";"+b.x+";"+b.y+(3===(a&3)?"m":"M"))):(c=[],d(c,a),d(c,b.x),d(c,b.y),j.send(e.C0.ESC+"[M"+String.fromCharCode.apply(String,c)))}function h(a){var b,c;if(null!=a.pageX){b=a.pageX;a=a.pageY;for(c=j.element;c&&c!==j.document.documentElement;)b-=c.offsetLeft,a-=c.offsetTop,c="offsetParent"in c?c.offsetParent:c.parentNode;b=Math.ceil(b/j.charMeasure.width);a=Math.ceil(a/
j.charMeasure.height);0>b&&(b=0);b>j.cols&&(b=j.cols);0>a&&(a=0);a>j.rows&&(a=j.rows);return{x:b+32,y:a+32,type:"wheel"}}}var i=this.element,j=this,k=32;f(i,"mousedown",function(d){if(j.mouseEvents){a(d);j.focus();if(j.vt200Mouse)return d.overrideType="mouseup",a(d),j.cancel(d);j.normalMouse&&f(j.document,"mousemove",b);j.x10Mouse||f(j.document,"mouseup",function A(d){a(d);j.normalMouse&&c(j.document,"mousemove",b);c(j.document,"mouseup",A);return j.cancel(d)});return j.cancel(d)}});f(i,"wheel",function(b){if(j.mouseEvents&&
!j.x10Mouse&&!j.vt300Mouse&&!j.decLocator)return a(b),j.cancel(b)});f(i,"wheel",function(a){if(!j.mouseEvents)return j.viewport.onWheel(a),j.cancel(a)})};b.prototype.destroy=function(){this.writable=this.readable=!1;this._events={};this.handler=function(){};this.write=function(){};this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)};b.prototype.refresh=function(a,b){this.renderer&&this.renderer.queueRefresh(a,b)};b.prototype.queueLinkification=function(a,b){if(this.linkifier)for(var c=
a;c<=b;c++)this.linkifier.linkifyRow(c)};b.prototype.showCursor=function(){this.cursorState||(this.cursorState=1,this.refresh(this.y,this.y))};b.prototype.scroll=function(){var a;this.lines.length===this.lines.maxLength&&(this.lines.trimStart(1),this.ybase--,0!==this.ydisp&&this.ydisp--);this.ybase++;this.userScrolling||(this.ydisp=this.ybase);a=this.ybase+this.rows-1;a-=this.rows-1-this.scrollBottom;a===this.lines.length?this.lines.push(this.blankLine()):this.lines.splice(a,0,this.blankLine());0!==
this.scrollTop&&(0!==this.ybase&&(this.ybase--,this.userScrolling||(this.ydisp=this.ybase)),this.lines.splice(this.ybase+this.scrollTop,1));this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom);this.emit("scroll",this.ydisp)};b.prototype.scrollDisp=function(a,b){0>a?this.userScrolling=!0:a+this.ydisp>=this.ybase&&(this.userScrolling=!1);this.ydisp+=a;this.ydisp>this.ybase?this.ydisp=this.ybase:0>this.ydisp&&(this.ydisp=0);b||this.emit("scroll",this.ydisp);this.refresh(0,this.rows-1)};
b.prototype.scrollPages=function(a){this.scrollDisp(a*(this.rows-1))};b.prototype.scrollToTop=function(){this.scrollDisp(-this.ydisp)};b.prototype.scrollToBottom=function(){this.scrollDisp(this.ybase-this.ydisp)};b.prototype.write=function(a){this.writeBuffer.push(a);this.options.useFlowControl&&!this.xoffSentToCatchUp&&5<=this.writeBuffer.length&&(this.send(e.C0.DC3),this.xoffSentToCatchUp=!0);if(!this.writeInProgress&&0<this.writeBuffer.length){this.writeInProgress=!0;var b=this;setTimeout(function(){b.innerWrite()})}};
b.prototype.innerWrite=function(){for(var a=this.writeBuffer.splice(0,300);0<a.length;){var b=a.shift();this.xoffSentToCatchUp&&0===a.length&&0===this.writeBuffer.length&&(this.send(e.C0.DC1),this.xoffSentToCatchUp=!1);this.refreshEnd=this.refreshStart=this.y;this.parser.parse(b);this.updateRange(this.y);this.refresh(this.refreshStart,this.refreshEnd)}if(0<this.writeBuffer.length){var c=this;setTimeout(function(){c.innerWrite()},0)}else this.writeInProgress=!1};b.prototype.writeln=function(a){this.write(a+
"\r\n")};b.prototype.attachCustomKeydownHandler=function(a){this.customKeydownHandler=a};b.prototype.attachHypertextLinkHandler=function(a){if(!this.linkifier)throw Error("Cannot attach a hypertext link handler before Terminal.open is called");this.linkifier.attachHypertextLinkHandler(a);this.refresh(0,this.rows-1)};b.prototype.registerLinkMatcher=function(a,b,c){if(this.linkifier)return a=this.linkifier.registerLinkMatcher(a,b,c),this.refresh(0,this.rows-1),a};b.prototype.deregisterLinkMatcher=function(a){this.linkifier&&
this.linkifier.deregisterLinkMatcher(a)&&this.refresh(0,this.rows-1)};b.prototype.keyDown=function(b){if(this.customKeydownHandler&&!1===this.customKeydownHandler(b))return!1;if(!this.compositionHelper.keydown.bind(this.compositionHelper)(b))return this.ybase!==this.ydisp&&this.scrollToBottom(),!1;var c=this.evaluateKeyEscapeSequence(b);c.key===e.C0.DC3?this.writeStopped=!0:c.key===e.C0.DC1&&(this.writeStopped=!1);if(c.scrollDisp)return this.scrollDisp(c.scrollDisp),this.cancel(b,!0);if(a(this,b))return!0;
c.cancel&&this.cancel(b,!0);if(!c.key)return!0;this.emit("keydown",b);this.emit("key",c.key,b);this.showCursor();this.handler(c.key);return this.cancel(b,!0)};b.prototype.evaluateKeyEscapeSequence=function(a){var b={cancel:!1,key:void 0,scrollDisp:void 0},c=a.shiftKey<<0|a.altKey<<1|a.ctrlKey<<2|a.metaKey<<3;switch(a.keyCode){case 8:if(a.shiftKey){b.key=e.C0.BS;break}b.key=e.C0.DEL;break;case 9:if(a.shiftKey){b.key=e.C0.ESC+"[Z";break}b.key=e.C0.HT;b.cancel=!0;break;case 13:b.key=e.C0.CR;b.cancel=
!0;break;case 27:b.key=e.C0.ESC;b.cancel=!0;break;case 37:c?(b.key=e.C0.ESC+"[1;"+(c+1)+"D",b.key==e.C0.ESC+"[1;3D"&&(b.key=this.browser.isMac?e.C0.ESC+"b":e.C0.ESC+"[1;5D")):b.key=this.applicationCursor?e.C0.ESC+"OD":e.C0.ESC+"[D";break;case 39:c?(b.key=e.C0.ESC+"[1;"+(c+1)+"C",b.key==e.C0.ESC+"[1;3C"&&(b.key=this.browser.isMac?e.C0.ESC+"f":e.C0.ESC+"[1;5C")):b.key=this.applicationCursor?e.C0.ESC+"OC":e.C0.ESC+"[C";break;case 38:c?(b.key=e.C0.ESC+"[1;"+(c+1)+"A",b.key==e.C0.ESC+"[1;3A"&&(b.key=e.C0.ESC+
"[1;5A")):b.key=this.applicationCursor?e.C0.ESC+"OA":e.C0.ESC+"[A";break;case 40:c?(b.key=e.C0.ESC+"[1;"+(c+1)+"B",b.key==e.C0.ESC+"[1;3B"&&(b.key=e.C0.ESC+"[1;5B")):b.key=this.applicationCursor?e.C0.ESC+"OB":e.C0.ESC+"[B";break;case 45:!a.shiftKey&&!a.ctrlKey&&(b.key=e.C0.ESC+"[2~");break;case 46:b.key=c?e.C0.ESC+"[3;"+(c+1)+"~":e.C0.ESC+"[3~";break;case 36:b.key=c?e.C0.ESC+"[1;"+(c+1)+"H":this.applicationCursor?e.C0.ESC+"OH":e.C0.ESC+"[H";break;case 35:b.key=c?e.C0.ESC+"[1;"+(c+1)+"F":this.applicationCursor?
e.C0.ESC+"OF":e.C0.ESC+"[F";break;case 33:a.shiftKey?b.scrollDisp=-(this.rows-1):b.key=e.C0.ESC+"[5~";break;case 34:a.shiftKey?b.scrollDisp=this.rows-1:b.key=e.C0.ESC+"[6~";break;case 112:b.key=c?e.C0.ESC+"[1;"+(c+1)+"P":e.C0.ESC+"OP";break;case 113:b.key=c?e.C0.ESC+"[1;"+(c+1)+"Q":e.C0.ESC+"OQ";break;case 114:b.key=c?e.C0.ESC+"[1;"+(c+1)+"R":e.C0.ESC+"OR";break;case 115:b.key=c?e.C0.ESC+"[1;"+(c+1)+"S":e.C0.ESC+"OS";break;case 116:b.key=c?e.C0.ESC+"[15;"+(c+1)+"~":e.C0.ESC+"[15~";break;case 117:b.key=
c?e.C0.ESC+"[17;"+(c+1)+"~":e.C0.ESC+"[17~";break;case 118:b.key=c?e.C0.ESC+"[18;"+(c+1)+"~":e.C0.ESC+"[18~";break;case 119:b.key=c?e.C0.ESC+"[19;"+(c+1)+"~":e.C0.ESC+"[19~";break;case 120:b.key=c?e.C0.ESC+"[20;"+(c+1)+"~":e.C0.ESC+"[20~";break;case 121:b.key=c?e.C0.ESC+"[21;"+(c+1)+"~":e.C0.ESC+"[21~";break;case 122:b.key=c?e.C0.ESC+"[23;"+(c+1)+"~":e.C0.ESC+"[23~";break;case 123:b.key=c?e.C0.ESC+"[24;"+(c+1)+"~":e.C0.ESC+"[24~";break;default:a.ctrlKey&&!a.shiftKey&&!a.altKey&&!a.metaKey?65<=a.keyCode&&
90>=a.keyCode?b.key=String.fromCharCode(a.keyCode-64):32===a.keyCode?b.key=String.fromCharCode(0):51<=a.keyCode&&55>=a.keyCode?b.key=String.fromCharCode(a.keyCode-51+27):56===a.keyCode?b.key=String.fromCharCode(127):219===a.keyCode?b.key=String.fromCharCode(27):220===a.keyCode?b.key=String.fromCharCode(28):221===a.keyCode&&(b.key=String.fromCharCode(29)):!this.browser.isMac&&a.altKey&&!a.ctrlKey&&!a.metaKey&&(65<=a.keyCode&&90>=a.keyCode?b.key=e.C0.ESC+String.fromCharCode(a.keyCode+32):192===a.keyCode?
b.key=e.C0.ESC+"`":48<=a.keyCode&&57>=a.keyCode&&(b.key=e.C0.ESC+(a.keyCode-48)))}return b};b.prototype.setgLevel=function(a){this.glevel=a;this.charset=this.charsets[a]};b.prototype.setgCharset=function(a,b){this.charsets[a]=b;this.glevel===a&&(this.charset=b)};b.prototype.keyPress=function(b){var c;this.cancel(b);if(b.charCode)c=b.charCode;else if(null==b.which)c=b.keyCode;else if(0!==b.which&&0!==b.charCode)c=b.which;else return!1;if(!c||(b.altKey||b.ctrlKey||b.metaKey)&&!a(this,b))return!1;c=
String.fromCharCode(c);this.emit("keypress",c,b);this.emit("key",c,b);this.showCursor();this.handler(c);return!1};b.prototype.send=function(a){var b=this;this.queue||setTimeout(function(){b.handler(b.queue);b.queue=""},1);this.queue+=a};b.prototype.bell=function(){if(this.visualBell){var a=this;this.element.style.borderColor="white";setTimeout(function(){a.element.style.borderColor=""},10);this.popOnBell&&this.focus()}};b.prototype.log=function(){this.debug&&this.context.console&&this.context.console.log&&
this.context.console.log.apply(this.context.console,Array.prototype.slice.call(arguments))};b.prototype.error=function(){this.debug&&this.context.console&&this.context.console.error&&this.context.console.error.apply(this.context.console,Array.prototype.slice.call(arguments))};b.prototype.resize=function(a,b){if(!isNaN(a)&&!isNaN(b)){var c,d,e;if(!(a===this.cols&&b===this.rows)){1>a&&(a=1);1>b&&(b=1);d=this.cols;if(d<a){d=[this.defAttr," ",1];for(c=this.lines.length;c--;)for(;this.lines.get(c).length<
a;)this.lines.get(c).push(d)}else for(c=this.lines.length;c--;)for(;this.lines.get(c).length>a;)this.lines.get(c).pop();this.cols=a;this.setupStops(this.cols);d=this.rows;e=0;if(d<b)for(;d++<b;)this.lines.length<b+this.ybase&&(0<this.ybase&&this.lines.length<=this.ybase+this.y+e+1?(this.ybase--,e++,0<this.ydisp&&this.ydisp--):this.lines.push(this.blankLine())),this.children.length<b&&this.insertRow();else for(;d-- >b;)this.lines.length>b+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():
(this.ybase++,this.ydisp++)),this.children.length>b&&(c=this.children.shift())&&c.parentNode.removeChild(c);this.rows=b;this.y>=b&&(this.y=b-1);e&&(this.y+=e);this.x>=a&&(this.x=a-1);this.scrollTop=0;this.scrollBottom=b-1;this.charMeasure.measure();this.refresh(0,this.rows-1);this.normal=null;this.geometry=[this.cols,this.rows];this.emit("resize",{terminal:this,cols:a,rows:b})}}};b.prototype.updateRange=function(a){a<this.refreshStart&&(this.refreshStart=a);a>this.refreshEnd&&(this.refreshEnd=a)};
b.prototype.maxRange=function(){this.refreshStart=0;this.refreshEnd=this.rows-1};b.prototype.setupStops=function(a){null!=a?this.tabs[a]||(a=this.prevStop(a)):(this.tabs={},a=0);for(;a<this.cols;a+=this.getOption("tabStopWidth"))this.tabs[a]=!0};b.prototype.prevStop=function(a){null==a&&(a=this.x);for(;!this.tabs[--a]&&0<a;);return a>=this.cols?this.cols-1:0>a?0:a};b.prototype.nextStop=function(a){null==a&&(a=this.x);for(;!this.tabs[++a]&&a<this.cols;);return a>=this.cols?this.cols-1:0>a?0:a};b.prototype.eraseRight=
function(a,b){var c=this.lines.get(this.ybase+b);if(c){for(var d=[this.eraseAttr()," ",1];a<this.cols;a++)c[a]=d;this.updateRange(b)}};b.prototype.eraseLeft=function(a,b){var c=this.lines.get(this.ybase+b);if(c){var d=[this.eraseAttr()," ",1];for(a++;a--;)c[a]=d;this.updateRange(b)}};b.prototype.clear=function(){if(!(0===this.ybase&&0===this.y)){this.lines.set(0,this.lines.get(this.ybase+this.y));this.lines.length=1;this.y=this.ybase=this.ydisp=0;for(var a=1;a<this.rows;a++)this.lines.push(this.blankLine());
this.refresh(0,this.rows-1);this.emit("scroll",this.ydisp)}};b.prototype.eraseLine=function(a){this.eraseRight(0,a)};b.prototype.blankLine=function(a){for(var a=[a?this.eraseAttr():this.defAttr," ",1],b=[],c=0;c<this.cols;c++)b[c]=a;return b};b.prototype.ch=function(a){return a?[this.eraseAttr()," ",1]:[this.defAttr," ",1]};b.prototype.is=function(a){return 0===(this.termName+"").indexOf(a)};b.prototype.handler=function(a){this.options.disableStdin||(this.ybase!==this.ydisp&&this.scrollToBottom(),
this.emit("data",a))};b.prototype.handleTitle=function(a){this.emit("title",a)};b.prototype.index=function(){this.y++;this.y>this.scrollBottom&&(this.y--,this.scroll());this.x>=this.cols&&this.x--};b.prototype.reverseIndex=function(){this.y===this.scrollTop?(this.lines.shiftElements(this.y+this.ybase,this.rows-1,1),this.lines.set(this.y+this.ybase,this.blankLine(!0)),this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)):this.y--};b.prototype.reset=function(){this.options.rows=this.rows;
this.options.cols=this.cols;var a=this.customKeydownHandler;b.call(this,this.options);this.customKeydownHandler=a;this.refresh(0,this.rows-1);this.viewport.syncScrollArea()};b.prototype.tabSet=function(){this.tabs[this.x]=!0};b.prototype.matchColor=o;o._cache={};o.distance=function(a,b,c,d,e,f){return Math.pow(30*(a-d),2)+Math.pow(59*(b-e),2)+Math.pow(11*(c-f),2)};b.EventEmitter=h.EventEmitter;b.inherits=d;b.on=f;b.off=c;b.cancel=function(a,b){if(this.cancelEvents||b)return a.preventDefault(),a.stopPropagation(),
!1};l.exports=b},{"./CompositionHelper":2,"./EscapeSequences":3,"./EventEmitter":4,"./InputHandler":5,"./Linkifier":6,"./Parser":7,"./Renderer":8,"./Viewport":9,"./handlers/Clipboard":10,"./utils/Browser":11,"./utils/CharMeasure":12,"./utils/CircularList":13}]},{},[15])(15)});
